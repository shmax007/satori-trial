<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Satori Strength Gym Reservation</title>
  <style>
    :root {
      --primary: #e63946;
      --secondary: #f1faee;
      --accent: #a8dadc;
      --dark: #1d3557;
    }
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      margin: 0;
      background: var(--dark);
      color: var(--secondary);
    }
    header {
      background: var(--primary);
      padding: 1rem;
      text-align: center;
    }
    h1 { margin: 0; font-size: 2rem; }
    h2 { color: var(--accent); }
    main { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .card { background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 12px; margin: 1rem 0; }
    .time-slots { display: flex; flex-wrap: wrap; gap: 10px; }
    .slot {
      flex: 1 1 calc(50% - 10px);
      background: var(--accent);
      color: var(--dark);
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
      font-weight: bold;
      cursor: pointer;
    }
    .slot.full { background: gray; cursor: not-allowed; }
    .slot.selected { background: var(--primary); color: white; }
    form { display: flex; flex-direction: column; gap: 10px; }
    input, button {
      padding: 0.8rem;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
    }
    button {
      background: var(--primary);
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    .alert { display: none; margin-top: 10px; padding: 10px; border-radius: 6px; }
    .alert.success { background: green; }
    .alert.error { background: red; }
    footer { text-align: center; padding: 1rem; margin-top: 2rem; font-size: 0.9rem; color: #aaa; }
  </style>
</head>
<body>
  <header>
    <h1>SATORI STRENGTH</h1>
    <p>Gym Reservation System</p>
  </header>

  <main>
    <div class="card">
      <h2>Available Time Slots</h2>
      <div class="time-slots" id="timeSlots"></div>
    </div>

    <div class="card">
      <h2>Make a Reservation</h2>
      <form id="reservationForm">
        <input type="text" id="name" placeholder="Your Name" required>
        <input type="email" id="email" placeholder="Your Email" required>
        <input type="hidden" id="selectedSlot" required>
        <button type="submit">Reserve Now</button>
      </form>
      <div class="alert success" id="successAlert">Reservation successful!</div>
      <div class="alert error" id="errorAlert">Something went wrong.</div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 Satori Strength</p>
  </footer>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js"></script>

  <script>
    // âœ… Replace this with your Firebase config
    const firebaseConfig = {
  apiKey: "AIzaSyCVZKRIoXIwGkUhdDlZf9Q8BkZU1uqpQ8I",
  authDomain: "satori-strength.firebaseapp.com",
  projectId: "satori-strength",
  storageBucket: "satori-strength.firebasestorage.app",
  messagingSenderId: "255120260921",
  appId: "1:255120260921:web:d69ed3858babae24e232e8"
};

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const timeSlots = [
      { id: 1, start: "6:00", end: "8:00", maxCapacity: 8 },
      { id: 2, start: "9:00", end: "10:00", maxCapacity: 8 },
      { id: 3, start: "12:00", end: "13:00", maxCapacity: 8 },
      { id: 4, start: "18:00", end: "20:00", maxCapacity: 8 },
    ];

    let selectedSlotId = null;

    async function renderTimeSlots() {
      const container = document.getElementById("timeSlots");
      container.innerHTML = "";
      const reservations = await getReservations();

      timeSlots.forEach(slot => {
        const count = reservations.filter(r => r.timeSlotId == slot.id).length;
        const div = document.createElement("div");
        div.className = "slot";
        div.textContent = `${slot.start} - ${slot.end} (${count}/${slot.maxCapacity})`;
        if (count >= slot.maxCapacity) {
          div.classList.add("full");
        } else {
          div.addEventListener("click", () => selectSlot(slot.id, div));
        }
        container.appendChild(div);
      });
    }

    function selectSlot(id, element) {
      document.querySelectorAll(".slot").forEach(s => s.classList.remove("selected"));
      element.classList.add("selected");
      selectedSlotId = id;
      document.getElementById("selectedSlot").value = id;
    }

    document.getElementById("reservationForm").addEventListener("submit", async e => {
      e.preventDefault();
      if (!selectedSlotId) {
        alert("Please select a time slot first.");
        return;
      }
      const reservation = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        timeSlotId: selectedSlotId,
        date: new Date().toLocaleDateString("en-GB"),
        bookingDate: new Date().toISOString()
      };
      try {
        await saveReservation(reservation);
        document.getElementById("successAlert").style.display = "block";
        setTimeout(() => document.getElementById("successAlert").style.display = "none", 3000);
        e.target.reset();
        selectedSlotId = null;
        renderTimeSlots();
      } catch (err) {
        console.error(err);
        document.getElementById("errorAlert").style.display = "block";
        setTimeout(() => document.getElementById("errorAlert").style.display = "none", 3000);
      }
    });

    async function saveReservation(reservation) {
      await db.collection("reservations").add(reservation);
    }

    async function getReservations() {
      const today = new Date().toLocaleDateString("en-GB");
      const snapshot = await db.collection("reservations")
        .where("date", "==", today).get();
      return snapshot.docs.map(doc => doc.data());
    }

    renderTimeSlots();
  </script>
</body>
</html>
